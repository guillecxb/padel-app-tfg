"use strict";(self.webpackChunkpadel_app=self.webpackChunkpadel_app||[]).push([[9119],{47926:(e,t,r)=>{r.d(t,{DR:()=>i,F3:()=>v,Tj:()=>l,UQ:()=>n,a8:()=>d,x0:()=>c});r(21858);var s=r(66984),a=r(21895);const o=s.J.injectEndpoints({endpoints:e=>({availableCourts:e.query({query:e=>{let{customer_id:t,date:r}=e;return{url:"/customers/".concat(t,"/available-courts/"),params:{date:r}}},providesTags:[a.n.Reservations]}),createReservation:e.mutation({query:e=>{let{user_id:t,court_id:r,reservation_time:s,customer_id:a}=e;return{url:"/reservations/",method:"POST",body:{user_id:t,court_id:r,reservation_time:s,customer_id:a}}},providesTags:[a.n.Reservations]}),getUserReservations:e.query({query:e=>{let{user_id:t}=e;return{url:"/users/".concat(t,"/reservations/")}},providesTags:[a.n.Reservations]}),deleteReservation:e.mutation({query:e=>({url:"/reservations/".concat(e,"/"),method:"DELETE"}),invalidatesTags:[a.n.Reservations]}),getCustomerReservations:e.query({query:e=>{let{customer_id:t}=e;return{url:"/customers/".concat(t,"/reservations/")}},providesTags:[a.n.Reservations]}),getCustomerReservationsByDate:e.query({query:e=>{let{customer_id:t,from_date:r}=e;return{url:"/customers/".concat(t,"/reservations-by-date/"),params:r?{from_date:r}:{}}},providesTags:[a.n.Reservations]}),getReservationCountByCourt:e.query({query:e=>{let{customer_id:t}=e;return{url:"/customers/".concat(t,"/reservations/count-by-court/")}},providesTags:[a.n.Reservations]}),createReview:e.mutation({query:e=>{let{court_id:t,user_id:r,reservation_id:s,rating:a,comment:o}=e;return{url:"/reviews/",method:"POST",body:{court_id:t,user_id:r,reservation_id:s,rating:a,comment:o}}},invalidatesTags:[a.n.Reservations]})})}),{useAvailableCourtsQuery:n,useCreateReservationMutation:i,useGetUserReservationsQuery:l,useDeleteReservationMutation:d,useGetCustomerReservationsQuery:c,useGetCustomerReservationsByDateQuery:u,useGetReservationCountByCourtQuery:m,useCreateReviewMutation:v}=o},21429:(e,t,r)=>{r.d(t,{Gi:()=>d,Hr:()=>n,cR:()=>c,fR:()=>l,pT:()=>o,zR:()=>i});const s="CRITICAL",a="WARNING",o="success",n="error",i={USER_PASS:"USER_PASS",MICROSOFT:"MICROSOFT"},l={WARNING:a,ERROR:s,OK:"OK"},d={PENDING:"PENDING",DEPLOYING:"DEPLOYING",ACTIVE:"ACTIVE",DRAFT:"DRAFT"},c={ALL_CONNECTED:"Connected",SOME_CONNECTED:"Some_Connected",ALL_DISCONNECTED:"Disconnected",ALL_SUSPENDED:"Suspended"}},23215:(e,t,r)=>{r.r(t),r.d(t,{default:()=>N});var s=r(47313),a=r(61113),o=r(70501),n=r(9506),i=r(63984),l=r(69099),d=r(94469),c=r(33604),u=r(96467),m=r(97762),v=r(4117),p=r(85281),b=(r(97594),r(58467)),Z=r(47926),g=r(55162),R=r(93397),f=r(65053),h=r(89600),y=r(14762),x=r(67234),C=r(83929),D=r(44758),j=r(1550),w=r(23306),_=r(88797),S=r(51405),T=r(68012),P=r(46417);const N=()=>{const{customerId:e}=(0,b.UO)(),t=parseInt(e),{data:r=[],isLoading:N,error:E}=(0,Z.x0)({customer_id:t}),A=(0,b.s0)(),I=(0,T.Qn)(),[L]=(0,Z.a8)(),[q,M]=(0,s.useState)([]),[k,F]=(0,s.useState)([]),[O,B]=(0,s.useState)(null),[G,Q]=(0,s.useState)(!1),[U,W]=(0,s.useState)(!1),[z,H]=(0,s.useState)(!1);(0,s.useEffect)((()=>{M(r)}),[r]),(0,s.useEffect)((()=>{F(q)}),[q]);const K=e=>{B(e),W(!0)},V=()=>{W(!1),B(null)},Y=(0,s.useMemo)((()=>[{name:"id",label:I("idReservation"),options:{customBodyRender:y.Fb}},{name:"court_id",label:I("courtNumber"),options:{customBodyRender:y.Fb}},{name:"reservation_time",label:I("dateAndTime"),options:{customBodyRender:e=>e?(0,h.Z)(new Date(e),"dd/MM/yyyy HH:mm"):"No especificado"}},{name:"user_id",label:I("idClient"),options:{customBodyRender:y.Fb}},{name:"actions",label:I("actions"),options:{customBodyRender:(e,t)=>{const r=t.rawRow.reservation_time;return new Date(r)<new Date?(0,P.jsx)(a.Z,{variant:"body2",color:"text.disabled",children:I("pastReservation")}):(0,y.qR)({id:t.rowData[0],handleDelete:K})},filter:!1,sort:!1,hideLabel:!0}}]),[K]),[J,X]=(0,s.useState)("desc");return(0,s.useEffect)((()=>{const e=new Date;let t=z?r:r.filter((t=>new Date(t.reservation_time)>=e));t=t.slice().sort(((e,t)=>{const r=new Date(e.reservation_time),s=new Date(t.reservation_time);return"asc"===J?r-s:s-r})),M(t)}),[r,z,J]),(0,P.jsxs)("div",{"data-testid":"reservations-dashboard-page",children:[(0,P.jsx)(f.Z,{title:I("reservationsTitle")}),(0,P.jsxs)(o.Z,{sx:{p:6},children:[(0,P.jsxs)(n.Z,{alignItems:"center",display:"flex",justifyContent:"space-between",mb:2,width:"100%",children:[(0,P.jsxs)(a.Z,{"data-testid":"count",variant:"h5",children:[I("totalReservations"),": ",404===(null===E||void 0===E?void 0:E.status)?0:r.length]}),(0,P.jsxs)(i.Z,{alignItems:"center",direction:"row",flexWrap:"wrap",justifyContent:"flex-end",spacing:2,children:[(0,P.jsx)(n.Z,{width:496,children:(0,P.jsx)(R.E,{disabled:N||E,searchOverFields:["id","court_id"],setRows:M,tableRows:r,variant:"filled"})}),(0,P.jsx)(n.Z,{children:(0,P.jsx)(l.Z,{"data-testid":"add",disabled:N||E,onClick:()=>{A(x.Z6.asCustomerCreateBooking)},size:"large",variant:"contained",children:I("bookACourt")})})]})]}),(0,P.jsxs)(n.Z,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,flexWrap:"wrap",gap:2,children:[(0,P.jsx)(C.Z,{control:(0,P.jsx)(D.Z,{checked:z,onChange:()=>H(!z),color:"primary"}),label:I("showPastReservations")}),(0,P.jsxs)(j.Z,{size:"small",sx:{minWidth:200},children:[(0,P.jsx)(w.Z,{id:"sort-order-label",children:I("sortBy")}),(0,P.jsxs)(_.Z,{labelId:"sort-order-label",id:"sort-order",value:J,label:"Ordenar por",onChange:e=>X(e.target.value),children:[(0,P.jsx)(S.Z,{value:"desc",children:I("mostRecentFirst")}),(0,P.jsx)(S.Z,{value:"asc",children:I("oldestFirst")})]})]})]}),(0,P.jsx)(g.Z,{columns:Y,data:404===(null===E||void 0===E?void 0:E.status)?[]:k,"data-testid":"reservations-table",empty:404===(null===E||void 0===E?void 0:E.status)||!r.length,error:404!==(null===E||void 0===E?void 0:E.status)&&E,isLoading:N,translationKey:"reservationsTable"}),404===(null===E||void 0===E?void 0:E.status)&&!N&&(0,P.jsx)(a.Z,{sx:{textAlign:"center",mt:2},children:I("noActiveReservations")})]}),(0,P.jsxs)(d.Z,{open:U,onClose:V,children:[(0,P.jsx)(c.Z,{children:I("confirmDeletionTitle")}),(0,P.jsx)(u.Z,{children:(0,P.jsx)(m.Z,{children:I("confirmDeletionText",{id:O})})}),(0,P.jsxs)(v.Z,{children:[(0,P.jsx)(l.Z,{onClick:V,disabled:G,children:I("cancel")}),(0,P.jsx)(l.Z,{onClick:async()=>{if(O){Q(!0);try{await L(O).unwrap(),console.log("Reserva con ID ".concat(O," eliminada."))}catch(E){console.error("Error al eliminar la reserva:",E)}finally{Q(!1),W(!1),B(null)}}},color:"error",disabled:G,startIcon:G&&(0,P.jsx)(p.Z,{size:20}),children:I(G?"deleting":"delete")})]})]})]})}},4117:(e,t,r)=>{r.d(t,{Z:()=>Z});var s=r(63366),a=r(87462),o=r(47313),n=r(83061),i=r(21921),l=r(17592),d=r(77342),c=r(77430),u=r(32298);function m(e){return(0,u.Z)("MuiDialogActions",e)}(0,c.Z)("MuiDialogActions",["root","spacing"]);var v=r(46417);const p=["className","disableSpacing"],b=(0,l.ZP)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[t.root,!r.disableSpacing&&t.spacing]}})((e=>{let{ownerState:t}=e;return(0,a.Z)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})})),Z=o.forwardRef((function(e,t){const r=(0,d.Z)({props:e,name:"MuiDialogActions"}),{className:o,disableSpacing:l=!1}=r,c=(0,s.Z)(r,p),u=(0,a.Z)({},r,{disableSpacing:l}),Z=(e=>{const{classes:t,disableSpacing:r}=e,s={root:["root",!r&&"spacing"]};return(0,i.Z)(s,m,t)})(u);return(0,v.jsx)(b,(0,a.Z)({className:(0,n.Z)(Z.root,o),ownerState:u,ref:t},c))}))},97762:(e,t,r)=>{r.d(t,{Z:()=>g});var s=r(63366),a=r(87462),o=r(47313),n=r(83061),i=r(21921),l=r(17592),d=r(77342),c=r(61113),u=r(77430),m=r(32298);function v(e){return(0,m.Z)("MuiDialogContentText",e)}(0,u.Z)("MuiDialogContentText",["root"]);var p=r(46417);const b=["children","className"],Z=(0,l.ZP)(c.Z,{shouldForwardProp:e=>(0,l.FO)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),g=o.forwardRef((function(e,t){const r=(0,d.Z)({props:e,name:"MuiDialogContentText"}),{className:o}=r,l=(0,s.Z)(r,b),c=(e=>{const{classes:t}=e,r=(0,i.Z)({root:["root"]},v,t);return(0,a.Z)({},t,r)})(l);return(0,p.jsx)(Z,(0,a.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:l,className:(0,n.Z)(c.root,o)},r,{classes:c}))}))},83929:(e,t,r)=>{r.d(t,{Z:()=>x});var s=r(63366),a=r(87462),o=r(47313),n=r(83061),i=r(21921),l=r(99008),d=r(61113),c=r(91615),u=r(17592),m=r(77342),v=r(77430),p=r(32298);function b(e){return(0,p.Z)("MuiFormControlLabel",e)}const Z=(0,v.Z)("MuiFormControlLabel",["root","labelPlacementStart","labelPlacementTop","labelPlacementBottom","disabled","label","error","required","asterisk"]);var g=r(80300),R=r(46417);const f=["checked","className","componentsProps","control","disabled","disableTypography","inputRef","label","labelPlacement","name","onChange","required","slotProps","value"],h=(0,u.ZP)("label",{name:"MuiFormControlLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:r}=e;return[{["& .".concat(Z.label)]:t.label},t.root,t["labelPlacement".concat((0,c.Z)(r.labelPlacement))]]}})((e=>{let{theme:t,ownerState:r}=e;return(0,a.Z)({display:"inline-flex",alignItems:"center",cursor:"pointer",verticalAlign:"middle",WebkitTapHighlightColor:"transparent",marginLeft:-11,marginRight:16,["&.".concat(Z.disabled)]:{cursor:"default"}},"start"===r.labelPlacement&&{flexDirection:"row-reverse",marginLeft:16,marginRight:-11},"top"===r.labelPlacement&&{flexDirection:"column-reverse",marginLeft:16},"bottom"===r.labelPlacement&&{flexDirection:"column",marginLeft:16},{["& .".concat(Z.label)]:{["&.".concat(Z.disabled)]:{color:(t.vars||t).palette.text.disabled}}})})),y=(0,u.ZP)("span",{name:"MuiFormControlLabel",slot:"Asterisk",overridesResolver:(e,t)=>t.asterisk})((e=>{let{theme:t}=e;return{["&.".concat(Z.error)]:{color:(t.vars||t).palette.error.main}}})),x=o.forwardRef((function(e,t){var r,u;const v=(0,m.Z)({props:e,name:"MuiFormControlLabel"}),{className:p,componentsProps:Z={},control:x,disabled:C,disableTypography:D,label:j,labelPlacement:w="end",required:_,slotProps:S={}}=v,T=(0,s.Z)(v,f),P=(0,l.Z)(),N=null!=(r=null!=C?C:x.props.disabled)?r:null==P?void 0:P.disabled,E=null!=_?_:x.props.required,A={disabled:N,required:E};["checked","name","onChange","value","inputRef"].forEach((e=>{"undefined"===typeof x.props[e]&&"undefined"!==typeof v[e]&&(A[e]=v[e])}));const I=(0,g.Z)({props:v,muiFormControl:P,states:["error"]}),L=(0,a.Z)({},v,{disabled:N,labelPlacement:w,required:E,error:I.error}),q=(e=>{const{classes:t,disabled:r,labelPlacement:s,error:a,required:o}=e,n={root:["root",r&&"disabled","labelPlacement".concat((0,c.Z)(s)),a&&"error",o&&"required"],label:["label",r&&"disabled"],asterisk:["asterisk",a&&"error"]};return(0,i.Z)(n,b,t)})(L),M=null!=(u=S.typography)?u:Z.typography;let k=j;return null==k||k.type===d.Z||D||(k=(0,R.jsx)(d.Z,(0,a.Z)({component:"span"},M,{className:(0,n.Z)(q.label,null==M?void 0:M.className),children:k}))),(0,R.jsxs)(h,(0,a.Z)({className:(0,n.Z)(q.root,p),ownerState:L,ref:t},T,{children:[o.cloneElement(x,A),k,E&&(0,R.jsxs)(y,{ownerState:L,"aria-hidden":!0,className:q.asterisk,children:["\u2009","*"]})]}))}))}}]);