"use strict";(self.webpackChunkpadel_app=self.webpackChunkpadel_app||[]).push([[9119],{47926:(e,t,s)=>{s.d(t,{DR:()=>i,Tj:()=>l,UQ:()=>n,a8:()=>d,x0:()=>u});s(21858);var r=s(66984),o=s(21895);const a=r.J.injectEndpoints({endpoints:e=>({availableCourts:e.query({query:e=>{let{customer_id:t,date:s}=e;return{url:"/customers/".concat(t,"/available-courts/"),params:{date:s}}},providesTags:[o.n.Reservations]}),createReservation:e.mutation({query:e=>{let{user_id:t,court_id:s,reservation_time:r,customer_id:o}=e;return{url:"/reservations/",method:"POST",body:{user_id:t,court_id:s,reservation_time:r,customer_id:o}}},providesTags:[o.n.Reservations]}),getUserReservations:e.query({query:e=>{let{user_id:t}=e;return{url:"/users/".concat(t,"/reservations/")}},providesTags:[o.n.Reservations]}),deleteReservation:e.mutation({query:e=>({url:"/reservations/".concat(e,"/"),method:"DELETE"}),invalidatesTags:[o.n.Reservations]}),getCustomerReservations:e.query({query:e=>{let{customer_id:t}=e;return{url:"/customers/".concat(t,"/reservations/")}},providesTags:[o.n.Reservations]}),getCustomerReservationsByDate:e.query({query:e=>{let{customer_id:t,from_date:s}=e;return{url:"/customers/".concat(t,"/reservations-by-date/"),params:s?{from_date:s}:{}}},providesTags:[o.n.Reservations]}),getReservationCountByCourt:e.query({query:e=>{let{customer_id:t}=e;return{url:"/customers/".concat(t,"/reservations/count-by-court/")}},providesTags:[o.n.Reservations]})})}),{useAvailableCourtsQuery:n,useCreateReservationMutation:i,useGetUserReservationsQuery:l,useDeleteReservationMutation:d,useGetCustomerReservationsQuery:u,useGetCustomerReservationsByDateQuery:c,useGetReservationCountByCourtQuery:v}=a},21429:(e,t,s)=>{s.d(t,{Gi:()=>d,Hr:()=>n,cR:()=>u,fR:()=>l,pT:()=>a,zR:()=>i});const r="CRITICAL",o="WARNING",a="success",n="error",i={USER_PASS:"USER_PASS",MICROSOFT:"MICROSOFT"},l={WARNING:o,ERROR:r,OK:"OK"},d={PENDING:"PENDING",DEPLOYING:"DEPLOYING",ACTIVE:"ACTIVE",DRAFT:"DRAFT"},u={ALL_CONNECTED:"Connected",SOME_CONNECTED:"Some_Connected",ALL_DISCONNECTED:"Disconnected",ALL_SUSPENDED:"Suspended"}},23215:(e,t,s)=>{s.r(t),s.d(t,{default:()=>h});var r=s(47313),o=s(70501),a=s(9506),n=s(61113),i=s(63984),l=s(69099),d=s(94469),u=s(33604),c=s(96467),v=s(97762),m=s(4117),p=s(85281),R=(s(97594),s(58467)),y=s(47926),g=s(55162),C=s(93397),Z=s(65053),f=s(89600),x=s(14762),D=s(67234),b=s(46417);const h=()=>{const{customerId:e}=(0,R.UO)(),t=parseInt(e),{data:s=[],isLoading:h,error:S}=(0,y.x0)({customer_id:t}),_=(0,R.s0)(),[T]=(0,y.a8)(),[j,E]=(0,r.useState)([]),[N,I]=(0,r.useState)([]),[w,A]=(0,r.useState)(null),[O,M]=(0,r.useState)(!1),[L,q]=(0,r.useState)(!1);(0,r.useEffect)((()=>{E(s)}),[s]),(0,r.useEffect)((()=>{I(j)}),[j]);const B=e=>{A(e),q(!0)},G=()=>{q(!1),A(null)},P=(0,r.useMemo)((()=>[{name:"id",label:"ID reservation",options:{customBodyRender:x.Fb}},{name:"court_id",label:"Court number",options:{customBodyRender:x.Fb}},{name:"reservation_time",label:"Date and Time",options:{customBodyRender:e=>e?(0,f.Z)(new Date(e),"dd/MM/yyyy HH:mm"):"No especificado"}},{name:"customer_id",label:"ID client",options:{customBodyRender:x.Fb}},{name:"actions",label:"Acciones",options:{customBodyRender:(e,t)=>{let{rowData:s}=t;return(0,x.qR)({id:s[0],handleDelete:B})},filter:!1,sort:!1,hideLabel:!0}}]),[B]);return(0,b.jsxs)("div",{"data-testid":"reservations-dashboard-page",children:[(0,b.jsx)(Z.Z,{title:"Reservations"}),(0,b.jsxs)(o.Z,{sx:{p:6},children:[(0,b.jsxs)(a.Z,{alignItems:"center",display:"flex",justifyContent:"space-between",mb:2,width:"100%",children:[(0,b.jsxs)(n.Z,{"data-testid":"count",variant:"h5",children:["Total reservations: ",404===(null===S||void 0===S?void 0:S.status)?0:s.length]}),(0,b.jsxs)(i.Z,{alignItems:"center",direction:"row",flexWrap:"wrap",justifyContent:"flex-end",spacing:2,children:[(0,b.jsx)(a.Z,{width:496,children:(0,b.jsx)(C.E,{disabled:h||S,searchOverFields:["id","court_id"],setRows:E,tableRows:s,variant:"filled"})}),(0,b.jsx)(a.Z,{children:(0,b.jsx)(l.Z,{"data-testid":"add",disabled:h||S,onClick:()=>{_(D.Z6.asCustomerCreateBooking)},size:"large",variant:"contained",children:"Book a Court"})})]})]}),(0,b.jsx)(g.Z,{columns:P,data:404===(null===S||void 0===S?void 0:S.status)?[]:N,"data-testid":"reservations-table",empty:404===(null===S||void 0===S?void 0:S.status)||!s.length,error:404!==(null===S||void 0===S?void 0:S.status)&&S,isLoading:h,translationKey:"reservationsTable"}),404===(null===S||void 0===S?void 0:S.status)&&!h&&(0,b.jsx)(n.Z,{sx:{textAlign:"center",mt:2},children:"No hay reservas activas."})]}),(0,b.jsxs)(d.Z,{open:L,onClose:G,children:[(0,b.jsx)(u.Z,{children:"Confirm Deletion"}),(0,b.jsx)(c.Z,{children:(0,b.jsxs)(v.Z,{children:["Are you sure you want to delete reservation with ID ",w,"?"]})}),(0,b.jsxs)(m.Z,{children:[(0,b.jsx)(l.Z,{onClick:G,disabled:O,children:"Cancel"}),(0,b.jsx)(l.Z,{onClick:async()=>{if(w){M(!0);try{await T(w).unwrap(),console.log("Reserva con ID ".concat(w," eliminada."))}catch(S){console.error("Error al eliminar la reserva:",S)}finally{M(!1),q(!1),A(null)}}},color:"error",disabled:O,startIcon:O&&(0,b.jsx)(p.Z,{size:20}),children:O?"Deleting...":"Delete"})]})]})]})}},4117:(e,t,s)=>{s.d(t,{Z:()=>y});var r=s(63366),o=s(87462),a=s(47313),n=s(83061),i=s(21921),l=s(17592),d=s(77342),u=s(77430),c=s(32298);function v(e){return(0,c.Z)("MuiDialogActions",e)}(0,u.Z)("MuiDialogActions",["root","spacing"]);var m=s(46417);const p=["className","disableSpacing"],R=(0,l.ZP)("div",{name:"MuiDialogActions",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,!s.disableSpacing&&t.spacing]}})((e=>{let{ownerState:t}=e;return(0,o.Z)({display:"flex",alignItems:"center",padding:8,justifyContent:"flex-end",flex:"0 0 auto"},!t.disableSpacing&&{"& > :not(:first-of-type)":{marginLeft:8}})})),y=a.forwardRef((function(e,t){const s=(0,d.Z)({props:e,name:"MuiDialogActions"}),{className:a,disableSpacing:l=!1}=s,u=(0,r.Z)(s,p),c=(0,o.Z)({},s,{disableSpacing:l}),y=(e=>{const{classes:t,disableSpacing:s}=e,r={root:["root",!s&&"spacing"]};return(0,i.Z)(r,v,t)})(c);return(0,m.jsx)(R,(0,o.Z)({className:(0,n.Z)(y.root,a),ownerState:c,ref:t},u))}))},97762:(e,t,s)=>{s.d(t,{Z:()=>g});var r=s(63366),o=s(87462),a=s(47313),n=s(83061),i=s(21921),l=s(17592),d=s(77342),u=s(61113),c=s(77430),v=s(32298);function m(e){return(0,v.Z)("MuiDialogContentText",e)}(0,c.Z)("MuiDialogContentText",["root"]);var p=s(46417);const R=["children","className"],y=(0,l.ZP)(u.Z,{shouldForwardProp:e=>(0,l.FO)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),g=a.forwardRef((function(e,t){const s=(0,d.Z)({props:e,name:"MuiDialogContentText"}),{className:a}=s,l=(0,r.Z)(s,R),u=(e=>{const{classes:t}=e,s=(0,i.Z)({root:["root"]},m,t);return(0,o.Z)({},t,s)})(l);return(0,p.jsx)(y,(0,o.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:l,className:(0,n.Z)(u.root,a)},s,{classes:u}))}))}}]);