"use strict";(self.webpackChunkpadel_app=self.webpackChunkpadel_app||[]).push([[1830],{16811:(e,t,r)=>{r.d(t,{Nv:()=>l,oZ:()=>c,rq:()=>i});var o=r(21858),s=r(38826),n=r(21895);const a=s.P.injectEndpoints({endpoints:e=>({customers:e.query({query:()=>"/customers/",providesTags:[n._.Customers]}),createCustomer:e.mutation({query:e=>({url:"".concat(o.yq,"/customers/"),method:"POST",formData:!0,headers:{[o.Vb]:o.xS},body:e}),invalidatesTags:[n._.Customers]}),updateCustomer:e.mutation({query:e=>{let{body:t,customerId:r}=e;return{url:"".concat(o.yq,"/customers/").concat(r,"/"),method:"PATCH",formData:!0,headers:{[o.Vb]:o.xS},body:t}},invalidatesTags:[n._.Customers]})})}),{useCustomersQuery:i,useCreateCustomerMutation:l,useUpdateCustomerMutation:c}=a},47926:(e,t,r)=>{r.d(t,{DR:()=>i,F3:()=>v,Tj:()=>l,UQ:()=>a,a8:()=>c,x0:()=>u});r(21858);var o=r(66984),s=r(21895);const n=o.J.injectEndpoints({endpoints:e=>({availableCourts:e.query({query:e=>{let{customer_id:t,date:r}=e;return{url:"/customers/".concat(t,"/available-courts/"),params:{date:r}}},providesTags:[s.n.Reservations]}),createReservation:e.mutation({query:e=>{let{user_id:t,court_id:r,reservation_time:o,customer_id:s}=e;return{url:"/reservations/",method:"POST",body:{user_id:t,court_id:r,reservation_time:o,customer_id:s}}},providesTags:[s.n.Reservations]}),getUserReservations:e.query({query:e=>{let{user_id:t}=e;return{url:"/users/".concat(t,"/reservations/")}},providesTags:[s.n.Reservations]}),deleteReservation:e.mutation({query:e=>({url:"/reservations/".concat(e,"/"),method:"DELETE"}),invalidatesTags:[s.n.Reservations]}),getCustomerReservations:e.query({query:e=>{let{customer_id:t}=e;return{url:"/customers/".concat(t,"/reservations/")}},providesTags:[s.n.Reservations]}),getCustomerReservationsByDate:e.query({query:e=>{let{customer_id:t,from_date:r}=e;return{url:"/customers/".concat(t,"/reservations-by-date/"),params:r?{from_date:r}:{}}},providesTags:[s.n.Reservations]}),getReservationCountByCourt:e.query({query:e=>{let{customer_id:t}=e;return{url:"/customers/".concat(t,"/reservations/count-by-court/")}},providesTags:[s.n.Reservations]}),createReview:e.mutation({query:e=>{let{court_id:t,user_id:r,reservation_id:o,rating:s,comment:n}=e;return{url:"/reviews/",method:"POST",body:{court_id:t,user_id:r,reservation_id:o,rating:s,comment:n}}},invalidatesTags:[s.n.Reservations]})})}),{useAvailableCourtsQuery:a,useCreateReservationMutation:i,useGetUserReservationsQuery:l,useDeleteReservationMutation:c,useGetCustomerReservationsQuery:u,useGetCustomerReservationsByDateQuery:d,useGetReservationCountByCourtQuery:m,useCreateReviewMutation:v}=n},51830:(e,t,r)=>{r.r(t),r.d(t,{default:()=>q});var o=r(47313),s=r(9506),n=r(61113),a=r(24631),i=r(9019),l=r(69099),c=r(94469),u=r(33604),d=r(96467),m=r(97762),v=r(4117),x=r(85281),p=r(43394),h=r(44948),y=r(64507),g=r(47926),Z=r(97594),j=r(59863),C=r(89600),b=r(58467),_=r(16811),T=r(67234),R=r(47131),f=r(54750),k=r(46417);const w=(0,f.Z)((0,k.jsx)("path",{d:"m12 8-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess"),D=(0,f.Z)((0,k.jsx)("path",{d:"M16.59 8.59 12 13.17 7.41 8.59 6 10l6 6 6-6z"}),"ExpandMore");var M=r(68012);const q=()=>{var e,t;const r=(0,b.TH)(),f=(0,b.s0)(),[q,S]=(0,o.useState)(null),[H,P]=(0,o.useState)(null),[A,I]=(0,o.useState)(null),[B,E]=(0,o.useState)(!1),[L,Q]=(0,o.useState)(!1),[F,z]=(0,o.useState)(!1),U=(0,M.Qn)(),{role:G,id:N}=(0,Z.v9)(j.jo),[O,V]=(0,o.useState)((null===(e=r.state)||void 0===e?void 0:e.customerId)||null),[J,W]=(0,o.useState)((null===(t=r.state)||void 0===t?void 0:t.customerLocation)||""),[K]=(0,g.DR)(),{data:X,isLoading:Y}=(0,_.rq)(),[$,ee]=(0,o.useState)({}),te=new Date,re=new Date(te);re.setMonth(te.getMonth()+2);const oe=[];for(let o=9;o<=22.5;o+=1.5){const e=Math.floor(o),t=o%1===.5?30:0;oe.push(new Date(0,0,0,e,t))}const se=q&&H?"".concat((0,C.Z)(new Date(q),"yyyy-MM-dd"),"T").concat((0,C.Z)(H,"HH:mm:ss")):null,{data:ne=[]}=(0,g.UQ)({customer_id:O,date:se},{skip:!se||!O}),ae=()=>{f(T.Z6.membersArea)};return(0,k.jsx)(p._,{dateAdapter:y.H,children:(0,k.jsxs)(s.Z,{sx:{padding:"16px"},children:[(0,k.jsx)(n.Z,{variant:"h5",sx:{textAlign:"center",marginBottom:4},children:O?U("bookingFor",{location:J}):U("selectClubToBook")}),!O&&!Y&&(0,k.jsxs)(a.Z,{select:!0,label:U("selectClubLabel"),value:O||"",onChange:e=>{const t=e.target.value,r=null===X||void 0===X?void 0:X.results.find((e=>e.id===parseInt(t)));V(t),W(r?r.location:"")},SelectProps:{native:!0},fullWidth:!0,children:[(0,k.jsx)("option",{value:"",disabled:!0,hidden:!0})," ",null===X||void 0===X?void 0:X.results.map((e=>(0,k.jsx)("option",{value:e.id,children:e.location},e.id)))]}),(0,k.jsx)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:4},children:(0,k.jsx)(h.M,{label:U("bookingDateLabel"),value:q,onChange:e=>S(e),renderInput:e=>(0,k.jsx)(a.Z,{...e}),minDate:te,maxDate:re})}),q&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.Z,{variant:"h6",sx:{marginTop:4,textAlign:"center"},children:U("selectTime")}),(0,k.jsx)(i.ZP,{container:!0,spacing:2,sx:{marginTop:2},children:oe.map(((e,t)=>(0,k.jsx)(i.ZP,{item:!0,xs:6,md:3,children:(0,k.jsxs)(l.Z,{variant:H===e?"contained":"outlined",onClick:()=>P(e),children:[(0,C.Z)(e,"HH:mm")," - ",(0,C.Z)(new Date(e.getTime()+54e5),"HH:mm")]})},t)))})]}),H&&ne.length>0&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(n.Z,{variant:"h6",sx:{marginTop:4,textAlign:"center"},children:U("selectCourt")}),(0,k.jsx)(i.ZP,{container:!0,spacing:2,sx:{marginTop:2},children:ne.map((e=>(0,k.jsx)(i.ZP,{item:!0,xs:6,md:3,children:(0,k.jsxs)(s.Z,{sx:{padding:2,border:"2px solid",borderColor:e.available?"primary.main":"grey.400",backgroundColor:e.available?A===e.court_id?"primary.light":"white":"grey.200",color:e.available?"text.primary":"grey.600",textAlign:"center",borderRadius:1,cursor:e.available?"pointer":"not-allowed",pointerEvents:e.available?"auto":"none",display:"flex",flexDirection:"column",justifyContent:"space-between",height:"100%"},onClick:()=>{return t=e.court_id,void(ne.find((e=>e.court_id===t)).available&&I(t));var t},children:[(0,k.jsx)(n.Z,{variant:"h6",children:e.court_name}),(0,k.jsx)(n.Z,{variant:"body2",children:e.available?U("available"):U("occupied")}),e.review_count>0?(0,k.jsxs)(k.Fragment,{children:[(0,k.jsxs)(n.Z,{variant:"body2",sx:{mt:1},children:["\u2b50 ",e.average_rating.toFixed(1)," / 5"]}),e.reviews.slice(0,$[e.court_id]?5:1).map(((e,t)=>(0,k.jsxs)(n.Z,{variant:"caption",sx:{fontStyle:"italic",display:"block",mt:1},children:['"',e.comment,'"']},t))),(0,k.jsxs)(s.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",mt:1},children:[(0,k.jsx)(n.Z,{variant:"caption",color:"text.secondary",sx:{cursor:"pointer",fontSize:"0.75rem"},onClick:()=>ee((t=>({...t,[e.court_id]:!t[e.court_id]}))),children:$[e.court_id]?U("showLess"):U("showMore")}),(0,k.jsx)(R.Z,{size:"small",onClick:()=>ee((t=>({...t,[e.court_id]:!t[e.court_id]}))),children:$[e.court_id]?(0,k.jsx)(w,{}):(0,k.jsx)(D,{})})]})]}):(0,k.jsx)(n.Z,{variant:"caption",sx:{mt:1,color:"text.secondary"},children:U("noReviews")})]})},e.court_id)))})]}),A&&(0,k.jsx)(s.Z,{sx:{marginTop:4,textAlign:"center"},children:(0,k.jsx)(l.Z,{variant:"contained",color:"primary",onClick:()=>{E(!0)},children:U("bookCourt",{courtId:A})})}),(0,k.jsxs)(c.Z,{open:B,onClose:()=>E(!1),children:[(0,k.jsx)(u.Z,{children:U("confirmBookingTitle")}),(0,k.jsx)(d.Z,{children:(0,k.jsx)(m.Z,{children:U("confirmBookingText",{courtId:A,date:(0,C.Z)(new Date(se),"dd/MM/yyyy HH:mm")})})}),(0,k.jsxs)(v.Z,{children:[(0,k.jsxs)(l.Z,{onClick:()=>E(!1),color:"secondary",children:[" ",U("cancel")]}),(0,k.jsx)(l.Z,{onClick:async()=>{Q(!0);try{await K({user_id:N,court_id:A,reservation_time:se,customer_id:parseInt(O)}).unwrap(),Q(!1),E(!1),z(!0)}catch(e){Q(!1),console.error("Error al crear la reserva:",e)}},color:"primary",disabled:L,children:L?(0,k.jsx)(x.Z,{size:24}):U("book")})]})]}),(0,k.jsxs)(c.Z,{open:F,onClose:ae,children:[(0,k.jsx)(u.Z,{children:U("bookingSuccessTitle")}),(0,k.jsx)(d.Z,{children:(0,k.jsx)(m.Z,{children:U("bookingSuccessText",{courtId:A,date:(0,C.Z)(new Date(se),"dd/MM/yyyy HH:mm")})})}),(0,k.jsxs)(v.Z,{children:[(0,k.jsx)(l.Z,{onClick:()=>{z(!1),S(null),P(null),I(null)},color:"primary",children:U("bookAnother")}),(0,k.jsx)(l.Z,{onClick:ae,color:"secondary",children:U("goToMyBookings")})]})]})]})})}},97762:(e,t,r)=>{r.d(t,{Z:()=>y});var o=r(63366),s=r(87462),n=r(47313),a=r(83061),i=r(21921),l=r(17592),c=r(77342),u=r(61113),d=r(77430),m=r(32298);function v(e){return(0,m.Z)("MuiDialogContentText",e)}(0,d.Z)("MuiDialogContentText",["root"]);var x=r(46417);const p=["children","className"],h=(0,l.ZP)(u.Z,{shouldForwardProp:e=>(0,l.FO)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),y=n.forwardRef((function(e,t){const r=(0,c.Z)({props:e,name:"MuiDialogContentText"}),{className:n}=r,l=(0,o.Z)(r,p),u=(e=>{const{classes:t}=e,r=(0,i.Z)({root:["root"]},v,t);return(0,s.Z)({},t,r)})(l);return(0,x.jsx)(h,(0,s.Z)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:l,className:(0,a.Z)(u.root,n)},r,{classes:u}))}))}}]);